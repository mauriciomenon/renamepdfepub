**Analise Geral**
- Pipeline central combina extracao dedicada (`src/renamepdfepub/metadata_extractor.py:1`) com cache SQLite indexado (`src/renamepdfepub/metadata_cache.py:33`) para consolidar titulo, subtitulo, autores, editora, ano e ISBN10.
- Sistema iterativo separa dados validados, inferencias e metricas em tres bancos (`src/core/iterative_cache_system.py:52`) permitindo reforco gradual e descarte de registros duvidosos antes da tabela principal.
- Orquestrador de renomeacao consome os metadados aprovados, sanitiza nomes e gera padroes como `Autor - Titulo (Ano)` com protecao contra caracteres ilegais (`src/core/auto_rename_system.py:98`).
- Algoritmos de busca textual, fuzzy e ISBN formam camada de ampliacao de fontes (`src/renamepdfepub/search_algorithms/semantic_search.py:435`) enquanto integradores escolhem pesos e combinacoes (`src/core/algorithm_integration.py:64`).
- Diretoria `books/` fornece amostra real com PDFs, EPUBs e MOBIs usada pelos validadores funcionais e testes de regressao (`tests/real_algorithms_test.py:48`).

**Fluxo De Metadados**
- Etapa 1: ingestao registra arquivos locais ou remotos e cria predicoes baseadas no nome (`src/core/iterative_cache_system.py:142`).
- Etapa 2: extratores PDF/EPUB identificam ISBNs e campos limitando tamanho para evitar titulos gigantes (`src/renamepdfepub/metadata_extractor.py:149`).
- Etapa 3: enriquecimento adiciona dados externos via Amazon e outros conectores antes de promover registros confiaveis (`src/core/auto_rename_system.py:33`).
- Etapa 4: cache consolidado recebe somente entradas com boa confianca e hash do arquivo para rastrear revisoes (`src/core/iterative_cache_system.py:73`).
- Etapa 5: renamer aplica padroes personalizaveis e backups opcionais, mantendo lista de conflitos (`src/renamepdfepub/renamer.py:23`).
- Etapa 6: metricas de desempenho por iteracao guiam realimentacao e ajuste de pesos (`src/core/iterative_cache_system.py:103`).

**Interfaces E Ferramentas**
- `start_web.py` oferece launcher Streamlit com instalacao e geracao de dados de exemplo (`start_web.py:18`), enquanto `src/gui/web_launcher.py:12` cuida do bootstrap.
- `start_gui.py` e `src/gui` fornecem interface desktop, complementando CLI (`start_cli.py:18`) e relatorios HTML (`start_html.py:18`).
- Pacote `src/renamepdfepub/cli` trata de pipelines de linha de comando incluindo validacao e relatorios.
- `run_tests.py` coordena suites PyTest e ferramentas de qualidade, rodando tanto testes rapidos quanto analises prolongadas.
- Scripts em `utils/` e `scripts/` cobrem validacao de referencias, listas de arquivos e checks de integridade.

**Cobertura De Testes**
- `tests/real_algorithms_test.py:48` monta base com arquivos reais da pasta `books`, garantindo que ISBN, ano e editora venham de fontes autenticas.
- `tests/test_algorithms_functional.py` e `tests/test_metadata_and_algorithms.py` verificam integracao entre extratores, enriquecedores e cache.
- `tests/test_cache_and_database.py:277` assegura transacoes consistentes e rollback seguro entre as tres tabelas iterativas.
- `tests/test_improved_algorithms.py:33` monta banco de livros com variacao de categorias para medir precisao dos filtros.
- `src/core/v3_complete_system.py:1` cobre fluxo end-to-end combinando algoritmos e renomeacao simulada.

**Riscos E Observacoes**
- `src/core/auto_rename_system.py:186` ainda registra emojis nos logs, conflitando com a diretriz de evitar caracteres especiais.
- `src/gui/web_launcher.py:64` gera dados de exemplo aleatorios com nomes ficticios que podem poluir caches se promovidos sem filtro.
- Dependencia explicita do V3 agora sai de `src/core/v3_complete_system.py`, eliminando a ligacao com arquivos de teste.
- Existem multiplas variantes legadas em `legacy/` que replicam funcoes de cache e podem causar divergencias se reutilizadas sem controle.
- Cache iterativo cria tres bancos separados no diretorio `data/cache/iterative/`; e necessario planejar rotinas de limpeza e migracao ao promover para producao.

**Plano De Acao**
1. Mapear dependencias entre modulos ativos e variantes legadas, desativando imports de testes na execucao principal.
2. Padronizar pipeline de promocao: ingestao -> predicao -> validacao -> consolidacao, documentando criterios de confianca e filtros de tamanho de titulo.
3. Revisar logging e mensagens para remover emojis e caracteres proibidos, aplicando auditoria em todos os pontos de saida.
4. Fortalecer testes com dados reais: expandir suites que usam `books/`, cobrindo ISBN10, editora e ano nos tres formatos suportados.
5. Consolidar camada de cache e bancos iterativos com migracoes versionadas e politicas de limpeza automatica.
6. Harmonizar interfaces (CLI, GUI, web, html) para reutilizar o mesmo orquestrador de metadados, evitando divergencias entre fluxos de entrada.
